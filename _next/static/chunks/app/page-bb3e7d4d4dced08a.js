(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{5544:function(e,t,a){Promise.resolve().then(a.bind(a,5828))},5828:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return Z}});var i=a(7437),r=a(2265),s=a(3777);let n="https://shomeanjybtnaqsjizog.supabase.co",o="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNob21lYW5qeWJ0bmFxc2ppem9nIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzgxNzgwNDcsImV4cCI6MjA1Mzc1NDA0N30.vttkC8SkM1tex77a4Z0B-tRkVL1wxFOqiDKANzRFZhY";if(!n||!o)throw Error("Missing Supabase environment variables");let l=(0,s.eI)(n,o,{auth:{persistSession:!1},db:{schema:"public"}});var c=a(1906),d=a(5318),p=a(3812),m=a(4386),u=a(3145),g=a(5293),x=a(535),h=a(1994),v=a(3335);function b(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,v.m6)((0,h.W)(t))}let y=(0,x.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),f=r.forwardRef((e,t)=>{let{className:a,variant:r,size:s,asChild:n=!1,...o}=e,l=n?g.g7:"button";return(0,i.jsx)(l,{className:b(y({variant:r,size:s,className:a})),ref:t,...o})});function j(e){let{person:t,isVoted:a,onVote:s,loading:n}=e,o=(0,r.useRef)(null),l=(0,c.c)(0),g=(0,c.c)(0),x=(0,d.q)((0,p.H)(g,[-.5,.5],[15,-15])),h=(0,d.q)((0,p.H)(l,[-.5,.5],[-15,15]));return(0,i.jsxs)(m.E.div,{ref:o,onMouseMove:e=>{if(!o.current)return;let t=o.current.getBoundingClientRect(),a=t.width,i=t.height,r=e.clientX-t.left,s=e.clientY-t.top;l.set(r/a-.5),g.set(s/i-.5)},onMouseLeave:()=>{l.set(0),g.set(0)},style:{rotateX:x,rotateY:h,transformStyle:"preserve-3d"},initial:{opacity:0,y:20},animate:{opacity:1,y:0},whileHover:{z:20},className:"group relative h-[500px] cursor-pointer perspective-1000",children:[(0,i.jsx)("div",{className:"absolute -inset-0.5 rounded-2xl bg-gradient-to-r from-white/30 via-primary-light/30 to-white/30 opacity-0 blur transition-all duration-500 group-hover:opacity-100"}),(0,i.jsx)("div",{className:"absolute inset-0 rounded-2xl bg-gradient-to-r from-white/20 via-primary-light/20 to-white/20 opacity-0 group-hover:opacity-100",children:(0,i.jsx)("div",{className:"absolute inset-0 animate-spin-slow rounded-2xl bg-gradient-to-r from-transparent via-white/10 to-transparent"})}),(0,i.jsxs)("div",{className:"relative flex h-full flex-col items-center space-y-6 rounded-2xl bg-black/40 p-6 backdrop-blur-xl transition-all duration-500 group-hover:bg-black/60",children:[(0,i.jsx)("div",{className:"absolute inset-0 rounded-2xl border border-white/10"}),(0,i.jsxs)(m.E.div,{style:{translateZ:50},className:"relative h-64 w-64",children:[(0,i.jsx)("div",{className:"absolute -inset-1 rounded-xl bg-gradient-to-r from-white/30 via-primary-light/30 to-white/30 opacity-0 blur-md transition-opacity duration-500 group-hover:opacity-100"}),(0,i.jsxs)("div",{className:"relative h-full w-full overflow-hidden rounded-xl border border-white/10",children:[(0,i.jsx)(u.default,{src:t.image,alt:t.name,fill:!0,className:"object-cover transition-all duration-500 group-hover:scale-110",sizes:"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw",priority:!0}),(0,i.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent opacity-0 transition-opacity duration-500 group-hover:opacity-100"})]})]}),(0,i.jsxs)(m.E.h3,{style:{translateZ:75},className:"relative text-center text-2xl font-bold",dir:"rtl",children:[(0,i.jsx)("span",{className:"bg-gradient-to-r from-white via-primary-light to-white bg-clip-text text-transparent",children:t.name}),(0,i.jsx)("div",{className:"absolute -inset-2 -z-10 animate-pulse-slow opacity-0 blur-xl transition-opacity duration-500 group-hover:opacity-40",style:{background:"linear-gradient(90deg, var(--primary) -10%, var(--primary-light) 50%, var(--primary) 110%)"}})]}),(0,i.jsxs)(m.E.div,{style:{translateZ:100},className:"relative w-full",whileTap:{scale:.95},children:[(0,i.jsx)("div",{className:"absolute -inset-0.5 rounded-xl bg-gradient-to-r from-white/30 via-primary-light/30 to-white/30 opacity-0 blur transition-opacity duration-500 group-hover:opacity-100"}),(0,i.jsx)(f,{onClick:()=>!a&&s(t.id),disabled:a||n,className:b("relative w-full overflow-hidden rounded-xl border border-white/10 py-6 text-lg font-medium","bg-gradient-to-r from-primary to-primary-light","shadow-lg shadow-primary/20 transition-all duration-500","hover:shadow-xl hover:shadow-primary/30","disabled:opacity-80",a&&"bg-accent"),dir:"rtl",children:(0,i.jsx)("span",{className:"relative z-10 flex items-center justify-center gap-3",children:n?(0,i.jsx)("div",{className:"h-5 w-5 animate-spin rounded-full border-2 border-white border-t-transparent"}):a?(0,i.jsxs)(i.Fragment,{children:["تم التصويت",(0,i.jsx)(m.E.span,{initial:{scale:0},animate:{scale:1},className:"text-xl",children:"✓"})]}):"صوت الآن"})})]})]})]})}f.displayName="Button";var N=a(8938),w=a(5679);function _(e){let{people:t,totalVotes:a}=e,[s,n]=(0,r.useState)({}),o=(0,r.useRef)({});(0,N.p)(e=>{let a={},i={};t.forEach(t=>{a[t.id]=Math.floor(1e3+4e3*Math.random()+200*Math.sin(e/1e3)),i[t.id]=50+30*Math.sin(e/800)}),n(a),o.current=i});let l=[...t].sort((e,t)=>(s[t.id]||0)-(s[e.id]||0));return(0,i.jsxs)("div",{className:"bg-black/20 backdrop-blur-lg rounded-2xl p-6 border border-white/10",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2 mb-6",children:[(0,i.jsx)(w.Z,{className:"w-6 h-6 text-primary"}),(0,i.jsx)("h2",{className:"text-xl font-bold text-primary",children:"المتصدرون"})]}),(0,i.jsx)("div",{className:"space-y-4",children:l.map((e,t)=>{var r;let n=a>0?(s[e.id]/a*100).toFixed(1):"0.0";return(0,i.jsxs)(m.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1*t},className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsxs)("span",{className:"text-sm text-gray-400",children:["#",t+1]}),(0,i.jsx)("span",{className:"font-medium text-gray-200",children:e.name})]}),(0,i.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,i.jsx)(m.E.span,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"text-xl font-bold text-primary",children:null===(r=s[e.id])||void 0===r?void 0:r.toLocaleString()},s[e.id]),(0,i.jsxs)("span",{className:"text-sm text-gray-400",children:["(",n,"%)"]})]})]},e.id)})})]})}var E=a(9064);let k=[{id:"cat1",name:"Creators",nameEn:"Creators",participants:["سارة حيـون","نـبـيـل الـحـمـوتـي","فـوزيـة كـريـشـو","حسين ترك"]},{id:"cat2",name:"Sports Field",nameEn:"Athletes",participants:["منعم العبوضي","فهيم دراز & عبد الوهاب الخميري","محمد بنعمر","محمد قرقاش"]},{id:"cat3",name:"organizations",nameEn:"organizations",participants:["مريم بوعسيلة","شباب غيث","أشرف بلحيان","وليد الحدادي"]}];var z=a(1732);function I(){(0,r.useRef)(null);let{scrollYProgress:e}=(0,z.v)(),t=(0,p.H)(e,[0,1],["0%","50%"]);return(0,i.jsxs)("div",{className:"fixed inset-0 -z-10 overflow-hidden",children:[(0,i.jsx)("div",{className:"absolute inset-0 bg-gradient-to-b from-black via-background to-black opacity-90"}),(0,i.jsx)("div",{className:"absolute inset-0 bg-grid-premium opacity-20"}),(0,i.jsx)("div",{className:"absolute inset-0",children:(0,i.jsx)("div",{className:"cyber-lines"})}),(0,i.jsx)(m.E.div,{style:{y:t},className:"absolute inset-0",children:(0,i.jsx)("div",{className:"premium-orbs"})}),(0,i.jsx)("div",{className:"absolute inset-0",children:(0,i.jsx)("div",{className:"light-rays"})}),(0,i.jsx)("div",{className:"absolute inset-0 backdrop-blur-[100px]",children:(0,i.jsx)("div",{className:"glass-fog"})}),(0,i.jsx)("div",{className:"absolute inset-0 bg-gradient-to-tr from-primary/10 via-transparent to-primary/20"})]})}function S(){let{people:e,vote:t,castVote:a,loading:s,error:n}=function(){let[e,t]=(0,r.useState)([]),[a,i]=(0,r.useState)(null),[s,n]=(0,r.useState)(!0),[o,c]=(0,r.useState)(null);return(0,r.useEffect)(()=>{(async()=>{try{console.log("Starting to fetch participants..."),n(!0),c(null);let{count:e,error:a}=await l.from("people").select("*",{count:"exact",head:!0});if(console.log("Current participant count:",e),0===e){console.log("No participants found, inserting initial data...");let{error:e}=await l.from("people").insert([{name:"سارة حيـون",image:"/participants/1.jpg",category_id:"cat1",votes:0},{name:"نـبـيـل الـحـمـوتـي",image:"/participants/2.jpg",category_id:"cat1",votes:0},{name:"فـوزيـة كـريـشـو",image:"/participants/3.jpg",category_id:"cat1",votes:0},{name:"منعم العبوضي",image:"/participants/4.jpg",category_id:"cat2",votes:0},{name:"فهيم دراز & عبد الوهاب الخميري",image:"/participants/5.jpg",category_id:"cat2",votes:0},{name:"محمد بنعمر",image:"/participants/6.jpg",category_id:"cat2",votes:0},{name:"حسين ترك",image:"/participants/7.jpg",category_id:"cat2",votes:0},{name:"محمد قرقاش",image:"/participants/8.jpg",category_id:"cat2",votes:0},{name:"مريم بوعسيلة",image:"/participants/9.jpg",category_id:"cat3",votes:0},{name:"شباب غيث",image:"/participants/10.jpg",category_id:"cat3",votes:0},{name:"أشرف بلحيان",image:"/participants/11.jpg",category_id:"cat3",votes:0},{name:"وليد الحدادي",image:"/participants/12.jpg",category_id:"cat3",votes:0}]);if(e)throw console.error("Error inserting participants:",e),e}let{data:r,error:s}=await l.from("people").select("*").order("votes",{ascending:!1});if(s)throw console.error("Error fetching participants:",s),s;r?(console.log("Participants loaded successfully:",r),t(r)):console.log("No participants found after insert");let o=localStorage.getItem("user_id");if(o){let{data:e}=await l.from("votes").select("candidate_id").eq("user_id",o).single();e&&i(e.candidate_id)}}catch(e){console.error("Error in loadParticipants:",e),c(e.message||"Failed to load participants")}finally{n(!1)}})();let e=l.channel("people_changes").on("postgres_changes",{event:"UPDATE",schema:"public",table:"people"},e=>{t(t=>t.map(t=>t.id===e.new.id?{...t,...e.new}:t))}).subscribe();return()=>{e.unsubscribe()}},[]),{people:e,vote:a,castVote:async e=>{try{n(!0),c(null);let t=localStorage.getItem("user_id");t||(t=crypto.randomUUID(),localStorage.setItem("user_id",t));let{error:a}=await l.from("votes").insert([{user_id:t,candidate_id:e}]);if(a){if("23505"===a.code)throw Error("لقد قمت بالتصويت مسبقاً");throw a}return i(e),!0}catch(e){throw console.error("Error casting vote:",e),c(e.message||"Failed to cast vote"),e}finally{n(!1)}},loading:s,error:o}}(),o=k.map(t=>({...t,participants:e.filter(e=>e.category_id===t.id).sort((e,t)=>t.votes-e.votes)})),c=async e=>{try{await a(e)&&E.Am.success("تم التصويت بنجاح",{style:{background:"rgba(var(--primary), 0.1)",backdropFilter:"blur(10px)",border:"1px solid rgba(var(--primary), 0.2)",color:"white"}})}catch(e){E.Am.error(e.message||"حدث خطأ أثناء التصويت")}};return n?(0,i.jsx)("div",{className:"text-center text-red-500 p-4",children:n}):s&&0===e.length?(0,i.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,i.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary"})}):(console.log("People:",e),console.log("Categories with participants:",o),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(I,{}),(0,i.jsx)("div",{className:"relative min-h-screen w-full overflow-hidden bg-transparent px-4 pb-20 pt-10",children:(0,i.jsxs)(m.E.div,{initial:{opacity:0},animate:{opacity:1},className:"mx-auto max-w-7xl",children:[(0,i.jsxs)(m.E.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},className:"relative mb-16 text-center",children:[(0,i.jsx)("h1",{className:"relative z-10 bg-gradient-to-b from-white to-white/70 bg-clip-text text-4xl font-bold text-transparent md:text-5xl lg:text-6xl",children:"التصويت النهائي"}),(0,i.jsx)("div",{className:"absolute inset-0 -z-10 animate-pulse-slow bg-gradient-to-t from-primary/20 via-primary/5 to-transparent blur-3xl"})]}),(0,i.jsx)("div",{className:"space-y-20",children:o.map(e=>(0,i.jsxs)(m.E.section,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"relative",children:[(0,i.jsxs)("div",{className:"relative mb-8 text-center",children:[(0,i.jsx)(m.E.h2,{className:"text-3xl font-bold bg-gradient-to-r from-primary to-primary-light bg-clip-text text-transparent",initial:{opacity:0},animate:{opacity:1},children:e.name}),(0,i.jsx)("div",{className:"absolute inset-0 -z-10 animate-pulse-slow bg-gradient-to-t from-primary/10 via-primary/5 to-transparent blur-2xl"})]}),(0,i.jsx)(m.E.div,{className:"grid grid-cols-1 gap-8 md:grid-cols-2 lg:grid-cols-3",variants:{hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1}}},initial:"hidden",animate:"show",children:e.participants.map(e=>(0,i.jsx)(j,{person:e,isVoted:t===e.id,onVote:c,loading:s},e.id))}),(0,i.jsx)("div",{className:"mt-16 h-px w-full bg-gradient-to-r from-transparent via-primary/20 to-transparent"})]},e.id))})]})}),(0,i.jsx)(m.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mt-12",children:(0,i.jsx)(_,{people:e,totalVotes:e.reduce((e,t)=>e+t.votes,0)})})]}))}var C=a(5095);let M=m.E,F=C.M;function Z(){return(0,i.jsx)(F,{children:(0,i.jsxs)(M.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"min-h-screen bg-gradient-radial relative overflow-hidden",children:[(0,i.jsxs)("div",{className:"absolute inset-0 overflow-hidden",children:[(0,i.jsx)(M.div,{initial:{opacity:0},animate:{opacity:.7},className:"absolute top-0 -left-4 w-72 h-72 bg-primary/30 rounded-full mix-blend-multiply filter blur-xl animate-blob"}),(0,i.jsx)(M.div,{initial:{opacity:0},animate:{opacity:.7},transition:{delay:.2},className:"absolute top-0 -right-4 w-72 h-72 bg-secondary/30 rounded-full mix-blend-multiply filter blur-xl animate-blob animation-delay-2000"}),(0,i.jsx)(M.div,{initial:{opacity:0},animate:{opacity:.7},transition:{delay:.4},className:"absolute -bottom-8 left-20 w-72 h-72 bg-accent/30 rounded-full mix-blend-multiply filter blur-xl animate-blob animation-delay-4000"}),(0,i.jsx)("div",{className:"absolute inset-0 bg-grid-white/[0.05] bg-[length:50px_50px]"}),(0,i.jsx)("div",{className:"absolute inset-0 bg-gradient-to-b from-background/10 via-background/50 to-background/80"})]}),(0,i.jsxs)("div",{className:"relative z-10",children:[(0,i.jsx)(M.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"w-full flex justify-center pt-8 pb-4",children:(0,i.jsx)("div",{className:"relative w-48 h-24 md:w-64 md:h-32",children:(0,i.jsx)(u.default,{src:"/images/nadevoGroup.png",alt:"Nadevo Group",fill:!0,priority:!0,className:"object-contain"})})}),(0,i.jsx)("div",{className:"container mx-auto px-4 py-6",children:(0,i.jsx)(S,{})})]})]})})}}},function(e){e.O(0,[64,847,971,117,744],function(){return e(e.s=5544)}),_N_E=e.O()}]);